app-id: com.Cycling74.RNBORunner
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
command: /app/rnbooscquery
modules:
  - name: cmake
    buildsystem: simple
    build-commands:
      - mkdir -p ${FLATPAK_DEST}/cmake
      - mv * ${FLATPAK_DEST}/cmake/
    sources:
      - type: archive
        url: https://github.com/Kitware/CMake/releases/download/v3.27.0-rc3/cmake-3.27.0-rc3-linux-x86_64.tar.gz
        sha256: 22901396404f6784c0ee2c356b2ed68c03730dd5ab9af902ba7c41859f4df7cb
  - name: ruby
    buildsystem: autotools
    config-opts:
      - --prefix=/app/ruby
    sources:
      - type: archive
        url: https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.2.tar.gz
        sha256: 96c57558871a6748de5bc9f274e93f4b5aad06cd8f37befa0e8d94e7b8a423bc
  - name: RNBORunner
    buildsystem: simple
    build-commands:
      - cp ./bin/rnbooscquery ${FLATPAK_DEST}
      - ls -trl ${FLATPAK_DEST}
    sources:
      - type: dir
        path: ./build
cleanup:
  - cmake-3.27.0-rc3-linux-x86_64

#https://github.com/flathub/com.bitwig.BitwigStudio/blob/master/com.bitwig.BitwigStudio.yaml
finish-args:
  # We need MIDI, Audio, USB, DRI, and realtime performances
  - --device=all
  # Needed to talk with X11, Wayland, pulseaudio and pipewire
  - --share=ipc
  - --filesystem=xdg-run/pipewire-0
  - --socket=pulseaudio
  - --socket=x11
  # Wayland access
  - --socket=wayland
  # Needs to talk to the network:
  - --share=network
  # Needs to save files locally
  - --filesystem=host
  - --metadata=X-DConf=migrate-path=/org/gnome/dictionary/
